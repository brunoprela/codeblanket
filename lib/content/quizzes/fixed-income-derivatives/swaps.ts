export const swapsQuiz = [
  {
    id: 'sw-q-1',
    question:
      'Build an interest rate swap pricing and risk management platform that: (1) Bootstraps discount curve from swap rates (2yr, 5yr, 10yr, 30yr market quotes), (2) Prices vanilla swaps (pay fixed vs receive fixed) using bootstrapped curve, (3) Calculates Greeks (DV01, DV02/convexity, vega to swaption vol), (4) Manages swap portfolio (aggregate DV01, net exposure, hedge recommendations), (5) Handles non-standard features (amortizing notional, step-up coupons, forward-starting swaps). Requirements: OIS discounting (use SOFR OIS curve, not swap curve itself), CSA management (collateral adjustments), CVA/DVA (counterparty risk valuation adjustments). How do you handle: curve construction (use futures for short end, swaps for long end)? Day count conventions (30/360, Actual/360, Actual/365)? Payment lag (T+2 settlement)? Multi-curve framework (forecasting curve ≠ discounting curve)?',
    sampleAnswer:
      'Swap pricing platform architecture: Discount curve bootstrapping: Market instruments: Futures (short-end, 0-2 years): ED/SOFR futures, strips out to 2yr, Swaps (long-end, 2-30 years): 2yr, 3yr, 5yr, 7yr, 10yr, 20yr, 30yr swap rates, Fetch: From Bloomberg (USSW2, USSW10, etc.) or broker quotes, Sequential bootstrap: Start with overnight: DF(0) = 1.0, 3-month rate from futures: DF(0.25) = 1 / (1 + futures_rate × 0.25), 6-month, 1yr, 2yr from futures/FRAs: solve iteratively, 3yr+ from swap rates: Swap equation: Swap_rate × Σ(DF_i × Fraction_i) = (1 - DF_final), solve for DF_final, Example 5yr swap @ 4.5%: 0.045 × (DF_0.5 + DF_1.0 + ... + DF_5.0) / 2 = 1 - DF_5.0, solve: DF_5.0, Build: (maturity, discount_factor) pairs, interpolate with cubic spline or log-linear for intermediate dates, OIS discounting: Forecasting curve: Built from swap rates (project future SOFR fixings), Discounting curve: Built from OIS rates (overnight indexed swaps), Why different: Collateralized swaps discount at OIS (collateral earns overnight rate), Uncollateralized: Discount at counterparty funding rate (LIBOR+spread historically), Post-2008: Most swaps collateralized → use OIS discounting, Implementation: Build two curves: OIS_curve (for discounting), SOFR_curve (for forecasting floating payments), Vanilla swap pricing: Fixed leg PV: For each payment date t_i: Fixed_payment_i = Fixed_rate × Notional × Day_count_fraction_i, DF_i = OIS_curve.df(t_i), PV_fixed = Σ(Fixed_payment_i × DF_i), Floating leg PV: For each period [t_(i-1), t_i]: Forward_rate_i = SOFR_curve.forward_rate(t_(i-1), t_i), Floating_payment_i = Forward_rate_i × Notional × DCF_i, DF_i = OIS_curve.df(t_i), PV_floating = Σ(Floating_payment_i × DF_i), Swap NPV: Pay-fixed: NPV = PV_floating - PV_fixed, Receive-fixed: NPV = PV_fixed - PV_floating, Day count conventions: Fixed leg (USD swaps): 30/360 (assume 30 days per month, 360 per year), DCF = (360 × (Y2-Y1) + 30 × (M2-M1) + (D2-D1)) / 360, Example: Jan 15 to Jul 15 = (0 + 30×6 + 0) / 360 = 180/360 = 0.5, Floating leg (SOFR): Actual/360, DCF = Actual_days / 360, Example: 182 days / 360 = 0.5056, Implementation: Store convention per leg, calculate precisely (affects payments by 1-2bp), Greeks calculation: DV01 (dollar value of 01): Bump entire curve +1bp, reprice swap: value_up, Bump curve -1bp, reprice: value_down, DV01 = (value_down - value_up) / 2, Interpretation: $10,000 DV01 = gain $10K if rates fall 1bp, Key Rates Duration (KRD): Bump individual curve points (2yr, 5yr, 10yr separately), measure sensitivity to each, useful for targeted hedging, Convexity (DV02): Convexity = (value_up + value_down - 2 × value_0) / (0.0001)², second derivative of value w.r.t. rates, positive convexity: gains accelerate when rates fall, Vega (swaption vol): For swaps with embedded options (callable swaps): ∂value / ∂volatility, bump implied vol +1%, reprice, Portfolio management: Aggregate risk: Total_DV01 = Σ(Swap_i_DV01 × Notional_i), Net by maturity bucket (0-2yr, 2-5yr, 5-10yr, 10yr+), Identify concentrations (e.g., $50M DV01 in 10yr), Hedge recommendations: If Total_DV01 = +$1M (long duration): Hedge: Pay fixed on $X notional to neutralize, Optimal: Use liquid tenors (5yr, 10yr), minimize transaction costs, Optimization: Minimize basis risk, match key rate durations, Amortizing swaps: Notional declines over time: Notional_t = Initial_notional × (1 - Amortization_rate × t), Example: $100M initial, 10% annual amortization: Year 1: $100M, Year 2: $90M, Year 3: $80M, ..., Pricing: Calculate each payment with corresponding notional, sum PVs, DV01: Lower than bullet swap (less notional in later years), Step-up coupons: Fixed rate increases over time: Years 1-5: 4.0%, Years 6-10: 5.0%, Pricing: Use appropriate rate for each period, sum PVs, Use: Attractive for borrowers expecting income growth, Forward-starting swaps: Swap starts in future (e.g., 2-year forward-starting 5-year swap), Pricing: Calculate forward swap rate: Rate such that PV = 0 starting at forward date, use forward discount factors, Trading: Hedge future financing needs, CSA management: Initial margin: Posted at trade inception (5-10% of notional typical), Variation margin: Daily mark-to-market settlement, if swap gains $500K value: Receive $500K collateral from counterparty, if loses: Post $500K collateral, Impact on pricing: Collateral earns overnight rate (OIS), hence OIS discounting, CVA/DVA: Credit Value Adjustment (CVA): Deduct from swap value for counterparty default risk, CVA = PD × LGD × Expected_positive_exposure, Example: PD=2%, LGD=60%, EPE=$5M → CVA = 0.02×0.6×$5M = $60K, Debit Value Adjustment (DVA): Add to swap value (benefit if YOU default), controversial (monetizing own default), Post-crisis: Most swaps cleared (CCP), CVA/DVA less relevant (clearinghouse default risk minimal), Payment lag: Standard: T+2 settlement (payment 2 business days after fixing date), Impact: Discount factor adjustment: PV = Payment × DF(pay_date), not DF(fixing_date), Minor effect: ~1-2bp for short-dated swaps, API design: POST /swaps/bootstrap with {market_rates} returns discount curve (OIS and forecast), POST /swaps/price with {notional, fixed_rate, tenor, direction} returns NPV and greeks, GET /swaps/portfolio returns aggregated risk metrics (DV01 by bucket), POST /swaps/hedge recommends trades to neutralize portfolio risk.',
    keyPoints: [
      'Curve bootstrap: Futures 0-2yr, swaps 2yr+, solve iteratively (swap_rate × Σ(DF×DCF) = 1-DF_final), cubic spline interpolate, OIS vs forecast curves',
      'Pricing: Fixed_PV = Σ(Fixed_pmt × DF_OIS), Float_PV = Σ(Forward_SOFR × Notional × DCF × DF_OIS), NPV = Float - Fixed for pay-fixed',
      'Day count: Fixed 30/360 (assume 30 days/mo), Float Actual/360 (actual days), DCF calculation affects payments 1-2bp, store convention per leg',
      'Greeks: DV01 = (val_down - val_up)/2 (bump ±1bp), Convexity = (up + down - 2×mid)/(0.0001)², KRD (individual curve points), Vega (swaption vol)',
      'CVA/DVA: CVA = PD×LGD×EPE (deduct for counterparty risk), DVA = benefit if you default (controversial), cleared swaps minimal CVA (CCP guarantee)',
    ],
  },
  {
    id: 'sw-q-2',
    question:
      'Design a currency swap trading and hedging system that: (1) Prices fixed-for-fixed and fixed-for-floating currency swaps, (2) Handles notional exchange (at inception and maturity, unlike IRS), (3) Manages FX risk (swap combines interest rate risk + FX risk), (4) Calculates cross-currency basis (deviation from covered interest parity), (5) Revalues swap daily in both currencies (dual currency exposure). Include: quanto adjustments, payment netting, FX forwards for hedging. How do you handle: quanto effects (correlation between FX and rates)? Collateral currency (post USD or EUR collateral for EUR/USD swap)? Cross-currency basis trading (exploit basis anomalies)? Corporate applications (hedge foreign subsidiaries)?',
    sampleAnswer:
      'Currency swap system architecture: Swap structure: Participants: Party A (USD), Party B (EUR), Notional exchange: Inception: A pays $110M, receives €100M, Maturity: A receives $110M, pays €100M (reverse), Interest payments: A pays EUR interest (3.5% on €100M), receives USD interest (5.0% on $110M), Frequency: Annual, semi-annual, or quarterly, Net: Only net interest if same dates (typically full exchange), Fixed-for-fixed pricing: USD curve: Build from USD swap rates, discount factors DF_USD(t), EUR curve: Build from EUR swap rates, discount factors DF_EUR(t), PV in USD: PV_USD_leg = -$110M + Σ($interest_i × DF_USD_i) + $110M × DF_USD_final, PV_EUR_leg = +€100M × Spot - Σ(€interest_i × Spot × DF_EUR_i) - €100M × Spot × DF_EUR_final, where Spot = current USD/EUR rate (e.g., 1.10), NPV_USD = PV_USD_leg + PV_EUR_leg (converted to USD), At inception: Set rates so NPV = 0, Fixed-for-floating: One leg floating (e.g., USD SOFR), forecast floating payments from forward curve, price similarly, Notional exchange handling: Cash flows: Record initial exchange (t=0): -$110M, +€100M × Spot, intermediate interest payments, final exchange (t=T): +$110M, -€100M × Spot, PV calculation: Discount each flow in its currency, convert to reporting currency (USD), FX risk: Swap is exposed to FX rate changes (unlike single-currency IRS), Example: Spot moves 1.10 → 1.15 (USD weakens): EUR leg worth more in USD terms, Swap value to USD payer increases, Dual risk: Interest rate risk in both currencies, FX risk (largest component typically), Cross-currency basis: Covered Interest Parity (CIP): F = S × (1 + r_USD) / (1 + r_EUR), forward FX rate from interest rate differential, Basis: Deviation from CIP, observed in markets post-2008, CCS Basis: Spread added to one currency to match market prices, Example: USD/EUR basis = -30bp, means: USD borrowers pay extra 30bp vs theoretical rate, Calculation: Solve for spread such that swap NPV = 0 at market FX forward, Market quotes: USD 3-month vs EUR 3-month + basis (-30bp), Basis trading: If basis widens (becomes more negative): Opportunity: Borrow USD, lend EUR, earn basis, Execute via currency swap: pay USD, receive EUR+basis, arbitrage if expected to tighten, Historical: EUR/USD basis: -30bp to -50bp (2011-2020), JPY/USD basis: -50bp to -80bp (strong demand for USD), Quanto adjustments: Definition: Correlation between FX rate and interest rates, If USD rates rise AND USD strengthens (positive correlation): USD payments higher, but received in stronger currency (double benefit), Adjustment: Add/subtract convexity term to swap rate, Formula: Quanto_adj = ρ × σ_FX × σ_rate × T, where ρ = correlation, σ = volatilities, Example: ρ=0.3, σ_FX=10%, σ_rate=1%, T=5yr: Adj = 0.3×0.1×0.01×5 = 0.0015 = 15bp, Collateral currency: CSA terms: Specify collateral currency (USD, EUR, or both), Impact: If EUR/USD swap, post USD collateral: Collateral earns USD OIS rate, advantage if USD rates > EUR rates, Choice: Optimize collateral currency for funding benefit, Multi-currency CSA: Allow posting in either currency (most flexible), Hedging FX risk: Swap contains FX exposure (notional amounts exchanged at different times), Hedge: Use FX forwards to lock in rates, Example: 5yr EUR/USD swap, net FX risk from final notional exchange, Hedge: Enter 5yr FX forward (sell €100M forward), locks in terminal FX rate, removes FX risk (pure interest rate risk remains), Dynamic: Rebalance FX hedge as swap delta changes, Daily revaluation: Mark-to-market in both currencies: NPV_USD = value in USD terms, NPV_EUR = value in EUR terms, Reporting: Choose functional currency (USD for US company), Convert: Use spot FX rate to convert EUR NPV to USD, P&L attribution: Interest rate component: Rates move, value changes (isolate via sensitivity), FX component: Spot moves, value changes (largest typically), Basis component: Cross-currency basis widens/tightens, Corporate hedging use case: Scenario: US company with European subsidiary, EUR revenues, USD debt, Risk: EUR cash flows, must convert to USD to service debt, FX exposure, Solution: EUR/USD currency swap: Receive EUR (match subsidiary revenues), Pay USD (match debt payments), locks in conversion rate, notional exchange offsets principal, Benefit: Hedge FX risk, match cash flows, reduce volatility, Cost: Swap spread + cross-currency basis (typically -30bp cost), Payment netting: If payment dates align (quarterly on both legs): Net payment = USD_payment - EUR_payment × Spot (in USD), Only net amount exchanged (reduces operational complexity), Cross-border: Legal/tax considerations (different jurisdictions), Typically: Full exchange (no netting) due to accounting treatment, API design: POST /currency-swaps/price with {notional_USD, notional_EUR, rates, tenor} returns NPV in both currencies, GET /currency-swaps/basis returns cross-currency basis quotes (USD/EUR, USD/JPY, etc.), POST /currency-swaps/hedge with {swap_id} recommends FX forward hedge for terminal exchange, GET /currency-swaps/mtm returns daily mark-to-market with P&L attribution (rates, FX, basis).',
    keyPoints: [
      'Structure: Exchange notionals (inception + maturity), pay/receive interest in different currencies, combine rate risk + FX risk, notional amounts ARE exchanged unlike IRS',
      'Pricing: PV_USD_leg (USD cash flows × DF_USD), PV_EUR_leg (EUR cash flows × DF_EUR × Spot), NPV = sum converted to reporting currency, set rates for NPV=0',
      'Cross-currency basis: Deviation from CIP, F ≠ S×(1+r_USD)/(1+r_EUR), typical -30bp to -50bp for EUR/USD, add spread to match market, basis trading opportunity',
      'FX hedging: Terminal notional exchange creates FX risk, hedge with FX forward (sell EUR forward), removes FX component (leaves rate risk), rebalance as delta changes',
      'Quanto: Correlation between FX and rates, adj = ρ×σ_FX×σ_rate×T (~15bp for typical params), collateral currency matters (earns OIS rate, optimize for funding benefit)',
    ],
  },
  {
    id: 'sw-q-3',
    question:
      'Implement a swap portfolio risk management system that: (1) Aggregates risk across 1000+ swaps (DV01, FX delta, vega), (2) Identifies risk concentrations (maturity buckets, currency exposures), (3) Optimizes hedges (minimize transaction costs while achieving target risk limits), (4) Simulates portfolio under stress scenarios (rates +200bp, FX moves ±10%, basis widening), (5) Calculates capital requirements (regulatory capital for swap exposures). Include: netting sets (bilateral netting with each counterparty), correlation effects (rates across currencies), basis risk (hedging with liquid instruments vs exact matches). How do you handle: novation (transferring swaps to new counterparty)? Compression (terminating offsetting swaps to reduce gross notional)? Central clearing (CCP margining vs bilateral)?',
    sampleAnswer:
      'Swap portfolio risk system: Risk aggregation: Position database: Store all swaps: (swap_id, counterparty, currency, notional, fixed_rate, maturity, direction), 1000+ swaps = complex portfolio, Greeks calculation: For each swap_i: DV01_i, convexity_i, FX_delta_i (if currency swap), vega_i (if embedded option), Calculate individually, then aggregate, Aggregate by currency: DV01_USD = Σ(DV01_i for USD swaps), DV01_EUR = Σ(DV01_i for EUR swaps), Convert to single currency: Total_DV01_USD = DV01_USD + DV01_EUR × EUR_USD_rate, Risk concentrations: Maturity buckets: 0-1yr: DV01_bucket1, 1-3yr: DV01_bucket2, 3-5yr, 5-10yr, 10yr+, Identify: If 5-10yr bucket = $5M DV01 out of $10M total (50% concentration), Counterparty: By counterparty: Net exposure (after netting), if top 3 counterparties = 60% of total exposure: Concentrated counterparty risk, Currency: USD vs EUR vs JPY vs GBP exposures, hedge ratios differ by currency (correlations), Risk limits: Set portfolio limits: Max DV01 per bucket: ±$1M, Max FX delta: ±$10M, Max single counterparty: 10% of total exposure, Alert when approaching (90% of limit), Hedge optimization: Objective: Achieve target risk profile (near-zero DV01 all buckets), Minimize: Transaction costs (bid-ask, commissions), Constraints: Use liquid instruments (2yr, 5yr, 10yr swaps, not 7yr), max number of hedges (simplicity), Optimization: Linear programming, Variables: x_i = notional of hedge instrument i, Constraints: Σ(DV01_i × x_i) ≈ -Portfolio_DV01_j for each bucket j, costs = Σ(spread_i × notional_i) minimized, Solution: Optimal hedge portfolio (e.g., pay fixed $50M 5yr, receive fixed $30M 10yr), Basis risk: Hedging: Use liquid instruments may not perfectly match, Example: Hedge 7yr swap exposure with 5yr + 10yr: basis risk (7yr rates vs 5yr/10yr combination), Acceptable: Small basis risk vs transaction cost savings, Monitor: Track hedge effectiveness (realized vs expected), Netting sets: Bilateral netting: With each counterparty, offset positive and negative exposures, Example: Swap A: +$5M MTM, Swap B: -$3M MTM, same counterparty, Net exposure: $2M (not $8M gross), Legal: ISDA Master Agreement + CSA enables netting, Regulatory: Basel III recognizes netting (lower capital requirements), Impact: Reduce exposure by 70-90% typically (many offsetting positions), Stress testing: Scenarios: Parallel rate shift: +200bp, -100bp, rates up/down across all currencies, Yield curve steepening: Short rates +50bp, long rates +200bp, Yield curve flattening: Short +200bp, long +50bp, FX shock: EUR/USD ±10%, JPY/USD ±15%, basis widening: Cross-currency basis widens -30bp → -80bp (stress), Calculation: For each scenario: Reprice all 1000+ swaps with shocked curves/FX, Portfolio_value_stressed - Portfolio_value_base = P&L under stress, Report: Max loss across all scenarios (e.g., -$50M under +200bp parallel shock), VaR: Historical VaR: Use past 250 days of rate/FX moves, reprice portfolio under historical changes, 95% VaR = 5th percentile loss = $8M (95% confident loss < $8M), Monte Carlo VaR: Simulate 10,000 scenarios (random rate/FX paths), reprice, VaR = percentile, Regulatory capital: SA-CCR (Standardized Approach for Counterparty Credit Risk): EAD (Exposure at Default) = α × (RC + PFE), where RC = replacement cost (current MTM positive), PFE = potential future exposure (add-on), α = 1.4, Add-on: Depends on notional, maturity, asset class, interest rate swaps: 0.5% of notional × maturity factor, Example: $100M 10yr swap: PFE = $100M × 0.5% × 1.5 (maturity factor) = $750K, RWA: EAD × 100% (counterparty risk weight) = Risk-weighted assets, Capital: 8% × RWA = minimum capital (Basel III), Cleared swaps: CCP (Central Counterparty): Initial margin posted, variation margin daily, Default: CCP guarantees trade (mutualized loss), Capital: Much lower for cleared swaps (CCP risk weight 2% vs 100% bilateral), Post-Dodd-Frank: Mandated clearing for standardized swaps (most IRS), Novation: Definition: Transfer swap to new counterparty (A novates swap to C, original counterparty B), Process: Close swap with A, open identical swap with C at current market price, Cash settlement: If MTM ≠ 0, A pays/receives difference, Use case: Exit position without closing (avoid market impact), regulatory requirement (move to CCP), Compression: Definition: Terminate offsetting swaps (reduce gross notional without changing net risk), Example: Pay fixed $100M 10yr swap + Receive fixed $90M 10yr swap: Compress to single net Pay fixed $10M swap, Benefits: Reduce notional by 90% ($190M → $10M), lower operational costs, regulatory capital (gross notional matters for some metrics), Process: TriOptima or CME compression services, multilateral compression runs quarterly, API design: GET /swap-portfolio/risk returns aggregate DV01 by bucket, FX delta, vega, counterparty exposure, POST /swap-portfolio/optimize with {target_risk} returns optimal hedge trades, POST /swap-portfolio/stress with {scenarios} returns P&L under each stress scenario, GET /swap-portfolio/capital returns SA-CCR calculations, RWA, required capital.',
    keyPoints: [
      'Aggregation: Calculate DV01 per swap, sum by currency/bucket (0-1yr, 1-3yr, ..., 10yr+), identify concentrations (50% in one bucket = risky), convert to single currency',
      'Hedge optimization: Minimize costs subject to target risk (DV01 near zero all buckets), use liquid instruments (2/5/10yr), linear programming (variables = hedge notionals)',
      'Netting: Bilateral netting (offset +/-$MTM same counterparty), legal (ISDA Master), reduces exposure 70-90%, regulatory capital benefit (Basel III recognizes netting)',
      'Stress testing: Parallel shift ±200bp, steepening/flattening, FX ±10%, basis widening -30bp→-80bp, reprice portfolio, VaR = 5th percentile loss, report max loss',
      'Capital: SA-CCR EAD = α×(RC+PFE), PFE = notional × 0.5% × maturity_factor, RWA = EAD×100%, capital = 8%×RWA, cleared swaps lower (CCP risk weight 2%)',
    ],
  },
];
