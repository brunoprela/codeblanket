export const creditDefaultSwapsQuiz = [
    {
        id: 'cds-q-1',
        question:
            'Build a CDS pricing and risk system that: (1) Bootstraps hazard rate curve from CDS spreads (1yr, 3yr, 5yr, 7yr, 10yr quotes), (2) Prices single-name CDS contracts using survival probabilities, (3) Calculates CS01 (credit spread sensitivity, $value per 1bp spread change), (4) Manages CDS portfolio (aggregate credit exposure, concentrations by sector/rating), (5) Handles credit events (default detection, settlement process, recovery auctions). Requirements: ISDA standard model implementation, upfront payments (running spread vs fixed coupon), accrued premium calculations. How do you handle: curve construction (solve iteratively for hazard rates)? Recovery rate assumptions (40% standard but varies)? Credit triangle (spread ↔ hazard rate ↔ survival probability conversions)? Big Bang Protocol (2009 standardization)?',
        sampleAnswer:
            'CDS pricing system architecture: Hazard rate curve bootstrapping: Market data: CDS spreads by tenor: 1yr: 80bp, 3yr: 120bp, 5yr: 150bp, 7yr: 165bp, 10yr: 180bp, From Bloomberg CDSW or Markit, Sequential bootstrap: 1-year hazard rate λ₁: Solve: CDS_spread_1yr = λ₁ × LGD / (discount_factor adjustment), Assume flat λ₁ over year, typical λ₁ ≈ spread / LGD for short tenor, Example: 80bp / 60% LGD ≈ 133bp hazard rate (simplification), 3-year: Known λ₁, solve for λ₂ (hazard rate years 1-3), Use 1yr and 3yr CDS spreads, solve iteratively: PV_premium(λ₁, λ₂) = PV_protection(λ₁, λ₂), Newton-Raphson to find λ₂, 5yr, 7yr, 10yr: Continue sequential bootstrap, each step uses previously solved λs, Result: Piecewise constant hazard rates: [λ₁, λ₂, λ₃, ...], Survival probability: S(t) = exp(-Σ λᵢ × Δtᵢ), Credit triangle: Three equivalent representations: CDS spread: Market observable (150bp for 5yr), Hazard rate: Instantaneous default intensity (λ), Survival probability: S(t) = exp(-λt), Conversions: Spread → Hazard: λ ≈ Spread / (LGD × Risky_duration), more precise: solve PV_premium = PV_protection, Hazard → Survival: S(t) = exp(-∫₀ᵗ λ(s)ds), constant λ: S(t) = exp(-λt), Survival → PD: Default_prob(t) = 1 - S(t), Single-name CDS pricing: Premium leg PV: For each quarterly payment t: Premium_pmt = Spread × Notional × 0.25 (quarterly), Survival_prob = S(t) from hazard curve, Discount = DF(t) from risk-free curve (OIS), PV_premium = Σ(Premium × S(t) × DF(t)), Protection leg PV: For each period [tᵢ₋₁, tᵢ]: Default_prob_period = S(tᵢ₋₁) - S(tᵢ), Payoff = (1 - Recovery) × Notional, Discount mid-period: DF((tᵢ₋₁+tᵢ)/2), PV_protection = Σ(Payoff × PD_period × DF_mid), Fair spread: Solve Spread such that PV_premium = PV_protection, Iterative solver (bisection or Newton), CS01 calculation: Definition: Change in CDS value per 1bp spread change, Numerical: Bump market spread +1bp: value_up, Bump -1bp: value_down, CS01 = (value_down - value_up) / 2, Interpretation: CS01 = $50,000 means: If spread widens 1bp, protection buyer gains $50K, If spread tightens 1bp, protection buyer loses $50K, Portfolio level: Sum CS01 across all contracts, Recovery rate handling: Standard: 40% for senior unsecured debt (LGD = 60%), Adjust by seniority: Senior secured: 60-80% recovery (LGD 20-40%), Subordinated: 20-30% recovery (LGD 70-80%), By industry: Financials: Lower recovery (30-35%) due to leverage, Industrials: Higher recovery (40-45%), sovereigns, Time-varying: In crisis (2008, 2020), recovery rates fall 10-15 points, use distressed debt market prices as proxy, Upfront payments (Big Bang 2009): Pre-2009: CDS traded at running spread (e.g., pay 200bp quarterly), Post-2009: Standardized coupons: 100bp or 500bp (North America), 25bp, 100bp, 500bp, 1000bp (Europe), Upfront = PV_protection - PV_premium(at standard coupon), Example: Fair spread = 300bp, Standard coupon = 100bp, protection worth more than premium at 100bp, Buyer pays upfront ≈ (300-100) × Risky_duration × Notional, Accrued premium: If trade mid-period (not coupon date): Accrued = Coupon × Days_since_last_payment / Days_in_period, Buyer pays seller accrued (compensate for partial period), Credit event handling: Detection: Monitor credit event determinations committee (CDEC), ISDA announces: Bankruptcy, failure to pay, restructuring (depending on contract), Automation: Bloomberg CDSW or Markit feeds trigger alerts, Settlement process: Auction: ISDA organizes auction 30 days post-event, determines recovery rate, Example: Lehman 2008 auction: 8.625% recovery (91.375% loss), Cash settlement: Protection seller pays: (100% - Recovery%) × Notional, Example: $10M notional, 8.625% recovery, payout = $9.1375M, Physical: Protection buyer delivers bonds, receives par (rare post-2009), Portfolio management: Aggregate exposure: Sum notional by reference entity, sector, rating, concentration risk: If top 10 names = 70% of exposure, too concentrated, Limits: Max $50M per name, max $200M per sector, Sector analysis: Financials: 30% of portfolio, Energy: 20%, Technology: 15%, Hedging: Use CDS index (CDX.IG) to hedge systematic credit risk, leaves idiosyncratic (single-name) risk, API design: POST /cds/bootstrap with {market_spreads} returns hazard rate curve, POST /cds/price with {reference_entity, notional, spread, tenor} returns NPV and CS01, GET /cds/portfolio returns aggregate metrics (total CS01, exposures by sector/rating), POST /cds/credit-event with {reference_entity} initiates settlement process.',
        keyPoints: [
            'Hazard curve: Bootstrap sequentially from CDS spreads (1/3/5/7/10yr), solve iteratively for piecewise λᵢ, S(t) = exp(-Σλᵢ×Δtᵢ), use in pricing',
            'Pricing: PV_premium = Σ(Spread×Notional×0.25×S(t)×DF(t)), PV_protection = Σ(LGD×Notional×PD_period×DF_mid), fair spread: PV_prem = PV_prot',
            'CS01: (value_down - value_up)/2 for ±1bp bump, protection buyer: positive CS01 (gain if spreads widen), aggregate portfolio CS01 for total credit exposure',
            'Recovery: 40% standard senior unsecured (LGD 60%), adjust by seniority (secured 60-80%, sub 20-30%) and industry (financials lower), crisis: -10-15pts',
            'Big Bang 2009: Standardized coupons (100bp or 500bp), upfront = PV_prot - PV_prem(std coupon), accrued premium pro-rated, auction settlement post-default',
        ],
    },
    {
        id: 'cds-q-2',
        question:
            'Design a CDS index trading and arbitrage system that: (1) Tracks major indices (CDX.IG, CDX.HY, iTraxx Europe, iTraxx Crossover), (2) Prices index vs sum of constituents (index basis), (3) Identifies arbitrage (index cheap vs singles, or vice versa), (4) Handles index roll (new series every 6 months, roll positions), (5) Analyzes tranche trading (equity, mezzanine, senior tranches of index). Include: on-the-run vs off-the-run, default cascades (one default affects tranche leverage), correlation modeling. How do you handle: index composition changes (names added/removed)? Tranche detachment points (e.g., 0-3% equity tranche)? Base correlation vs compound correlation? Standardized tranches?',
        sampleAnswer:
            'CDS index trading system: Index tracking: Major indices: CDX.IG Series 41: 125 North American investment grade names, CDX.HY Series 41: 100 North American high yield, iTraxx Europe Series 40: 125 European IG, iTraxx Crossover Series 40: 75 European HY, Data: Fetch from Markit or Bloomberg (index spread, constituent spreads), Update: Daily close prices, intraday for active trading, Index pricing: Weighted average: Index_spread = Σ(weight_i × spread_i) / Σ(weight_i), Standard: Equal weight (each name 1/125 for CDX.IG = 0.8% each), Adjust: Remove defaulted names from denominator, Example: 2 defaults in CDX.IG: Σ weights = 123/125 = 98.4%, Intrinsic: Calculate fair index spread from constituent spreads, Compare to traded index spread, Index basis: Definition: Index_traded - Index_intrinsic, Positive basis: Index trades wider than fair (index cheap), Negative basis: Index trades tighter than fair (index rich), Typical: ±5bp basis (transaction costs, liquidity differences), Arbitrage: If basis >10bp: Buy index (cheap), sell constituent CDS basket, convergence profit as basis narrows, Index roll: Schedule: New series every March and September (6-month cycle), Changes: 5-10 names replaced (downgrades, mergers, liquidity), Roll process: Old series (Series 40): Positions mature or rolled, New series (Series 41): Fresh 5yr tenor, new composition, Traders: Must decide: hold old (off-the-run) or roll to new (on-the-run), Roll basis: Old series spread - New series spread, typically 5-15bp, Trading: Roll spread trade (long old, short new), profit if roll basis widens, On-the-run vs off-the-run: On-the-run: Current series (most liquid, tightest spreads), 80% of volume, Off-the-run: Prior series (less liquid, wider bid-ask), aging positions, Liquidity: On-the-run bid-ask 1-2bp, Off-the-run 5-10bp, Premium: Off-the-run may trade 5bp wider due to illiquidity, Tranche trading: Structure: Index loss distributed by tranches (junior to senior), Equity tranche: 0-3% losses (first loss, highest risk, highest premium), Mezzanine: 3-7%, 7-10%, 10-15% (middle risk), Senior: 15-30%, 30-100% (last loss, lowest risk, lowest premium), Example: CDX.IG index $125M notional (125 names × $1M each), Equity: Covers first $3.75M losses (3% × $125M), if 4 names default @ 60% LGD: Loss = 4 × $1M × 60% = $2.4M, equity absorbs all, still $1.35M remaining, If 7 names default: Loss = $4.2M, equity wiped out ($3.75M), mezzanine takes $0.45M, Detachment points: Equity: 0% attachment, 3% detachment, Mezzanine 3-7%: 3% attachment, 7% detachment, Tranche spread: Equity: 500-2000bp (very high risk), Senior: 10-50bp (low risk), Correlation modeling: Key insight: Correlation affects tranche risk, High correlation: Defaults cluster → senior tranches risky (many simultaneous defaults), Low correlation: Defaults spread out → equity absorbs most, senior safe, Base correlation: Market-observed correlation by detachment point, Compound correlation: Single correlation for whole portfolio, Gaussian copula: Standard model (criticized post-2008), Default cascade: One default: Equity tranche leverage increases, Example: 0-3% tranche, 1 default (0.48% loss): Remaining: $3.75M - $0.6M = $3.15M protects remaining 124 names, Effective leverage up: Now 124 × 0.6M / $3.15M = 23.6:1 vs 20:1 before, Risk: Subsequent defaults wipe out equity faster (exponential risk), Arbitrage strategies: Index vs constituents: If index 60bp, intrinsic 55bp (5bp rich): Sell index, buy constituent basket, pocket 5bp as basis converges, Transaction costs: ~3bp roundtrip, net 2bp profit, Tranche correlation trade: If equity cheap (high spread) and senior rich (low spread): Buy equity, sell senior, Bet: Correlation lower than priced (defaults spread out, equity survives, senior unaffected), Profit: Carry from equity premium > senior premium, mark-to-market if correlation falls, Standardized tranches: ISDA standard: 0-3%, 3-7%, 7-10%, 10-15%, 15-30% for IG, 0-10%, 10-15%, 15-25%, 25-35%, 35-100% for HY, Liquidity: Concentrated in equity (0-3%) and senior (15-30%), Mezzanine less liquid (wider spreads), API design: GET /cds-index/quotes returns spreads for CDX.IG/HY, iTraxx Europe/Xover, POST /cds-index/basis returns index vs intrinsic spread, arbitrage signal, GET /cds-index/tranches?index=CDXIG returns tranche spreads (equity, mezz, senior), POST /cds-index/roll analyzes roll basis (old vs new series), recommends roll timing.',
        keyPoints: [
            'Index: CDX.IG (125 NA IG names), CDX.HY (100 HY), iTraxx Europe/Crossover, equal weight (0.8% each), index spread = weighted avg, roll every 6mo (new series)',
            'Index basis: Traded - Intrinsic, positive = index cheap (arb: buy index, sell singles), typical ±5bp, >10bp = trade opportunity, roll basis (old-new series)',
            'Tranches: 0-3% equity (first loss, 500-2000bp), 3-7% mezz, 15-30% senior (last loss, 10-50bp), loss cascade from junior to senior',
            'Default cascade: One default increases equity leverage (fewer names protect same tranche), exponential risk, subsequent defaults wipe out equity faster',
            'Correlation: High = senior risky (clustered defaults), Low = equity risky (absorbs spread-out defaults), base correlation by detachment point, copula model',
        ],
    },
    {
        id: 'cds-q-3',
        question:
            'Implement a counterparty risk management system for CDS portfolios that: (1) Calculates CVA (Credit Valuation Adjustment) and DVA (Debit Valuation Adjustment), (2) Manages collateral (CSA agreements, initial/variation margin), (3) Handles wrong-way risk (protection sold on correlated counterparty), (4) Simulates exposure under stress (counterparty defaults, widening spreads), (5) Optimizes netting sets (bilateral netting to reduce exposure). Requirements: EPE/ENE (Expected Positive/Negative Exposure), PFE (Potential Future Exposure), Basel III SA-CCR capital calculations. How do you handle: CCP clearing vs bilateral? Jump-to-default risk? Margin period of risk (MPOR, typically 10 days)? CVA desk hedging (managing CVA P&L)?',
        sampleAnswer:
            'CDS counterparty risk system: CVA/DVA framework: CVA (Credit Valuation Adjustment): Reduction in value due to counterparty default risk, Formula: CVA = LGD_cpty × Σ(EE_t × PD_t × DF_t), where EE_t = Expected Exposure (positive MTM), PD_t = counterparty default probability period t, LGD_cpty = loss given counterparty default (1 - Recovery), Example: EE = $5M average, counterparty PD = 2%, LGD = 60%, CVA = 0.6 × $5M × 0.02 × discount ≈ $60K, deduct from CDS value, DVA (Debit Valuation Adjustment): Increase in value if WE default, Formula: DVA = LGD_self × Σ(NE_t × PD_self_t × DF_t), where NE_t = Negative Exposure (we owe counterparty), Controversial: "Monetizing own default", Accounting: US GAAP requires DVA, many criticize, EPE/ENE calculation: Expected Positive Exposure (EPE): Average of positive MTM across scenarios, Simulate 10,000 paths for CDS spread movements, For each path t: If MTM > 0: Exposure_t = MTM_t, else: 0, EPE_t = average across all positive MTM scenarios, Expected Negative Exposure (ENE): Average negative MTM (exposure to us from counterparty perspective), Effective EPE: Time-weighted average: EEPE = Σ(EPE_t × Δt) / T, used for capital calculations, PFE (Potential Future Exposure): 95th or 99th percentile of exposure distribution, Example: 10,000 simulations, sort MTM at horizon, PFE_95 = 9,500th value (95th percentile), used for stress testing and limits, Collateral management: CSA (Credit Support Annex): Legal agreement for collateral posting, Terms: Threshold ($0-10M, below which no collateral), Minimum transfer amount ($500K typical), Initial margin (upfront, 10-20% of notional), Variation margin (daily MTM settlement), Variation margin: Daily: If MTM changes by $1M, post/receive $1M collateral, reduces exposure to ~$0 between margin calls, MPOR (Margin Period of Risk): Time to liquidate position if counterparty defaults, Standard: 10 business days for OTC derivatives, Exposure: Max loss during MPOR (no new collateral received), Wrong-way risk: Definition: Protection sold on entity correlated with counterparty, Example: Sell CDS protection on Bank A to Bank A (extreme wrong-way), If Bank A distresses: CDS spread widens (we owe Bank A more), AND Bank A likely to default (we lose collateral/payment), Detection: Monitor correlations, Counterparty = financial, protection on financials = wrong-way, Same sector/country = potential wrong-way, Mitigation: Avoid wrong-way trades (decline or charge premium), Require extra collateral (higher initial margin), Hedge: Buy protection on counterparty (CVA hedge), Netting: Bilateral netting: With each counterparty, net all positive and negative MTMs, Example: CDS A: +$5M, CDS B: -$3M, CDS C: +$2M, all with Counterparty X, Net exposure: $4M (not $10M gross), Legal: ISDA Master Agreement enables netting, close-out netting on default, Regulatory: Basel III recognizes netting (lower capital requirements), Impact: Reduce exposure 70-90% typically (many offsetting trades), CCP clearing: Central Counterparty Clearing: CDS novated to clearinghouse (LCH, ICE Clear), CCP becomes counterparty to both sides (mutualized risk), Benefits: No bilateral counterparty risk (CCP extremely unlikely to default), Initial margin: Lower than bilateral (CCP netting across all members), Default fund: Members contribute, covers losses if one defaults, Capital: SA-CCR risk weight 2% for cleared vs 100% bilateral (huge savings), Mandated: Post-Dodd-Frank, standardized CDS must clear, Jump-to-default risk: Scenario: Counterparty defaults suddenly (no warning), Exposure: No time to collect variation margin (gap risk), Modeling: Add jump component to exposure simulation, Jump size: Potential MTM change if counterparty spreads gap (could be 100s of bp), Historical: Lehman 2008, spreads 500bp → 5000bp in days (gap risk), SA-CCR capital: Formula: EAD = α × (RC + PFE), where α=1.4, RC (Replacement Cost) = max(current MTM - collateral, 0), PFE (Potential Future Exposure) = multiplier × Add-on, Add-on: Based on notional, maturity, asset class, CDS: 0.5% × Notional × Maturity_factor, Example: $100M 5yr CDS, Add-on = $100M × 0.5% × 1.0 = $500K, RWA: EAD × Risk_weight (100% bilateral, 2% cleared), Capital: 8% × RWA minimum (Basel III), CVA desk hedging: CVA P&L: CVA changes daily as counterparty spreads change, If counterparty spread widens: CVA increases (loss), If tightens: CVA decreases (gain), Hedge: Buy CDS protection on counterparty, counterparty spread widens: CDS protection gains offset CVA loss, Gamma hedging: CDS spread vs counterparty correlation (second-order), CVA desk: Specialized team managing aggregate CVA for bank, API design: GET /cds/cva?counterparty=X returns CVA, DVA, EPE, ENE for counterparty X, POST /cds/exposure-simulation with {positions, scenarios} returns PFE, stress exposures, POST /cds/collateral-optimize recommends netting sets to minimize collateral posted, GET /cds/capital returns SA-CCR calculations, RWA, required capital by counterparty.',
        keyPoints: [
            'CVA: LGD_cpty × Σ(EE×PD×DF), deduct from value for counterparty default risk, EPE = avg positive MTM (simulations), EEPE = time-weighted, PFE = 95th percentile',
            'Collateral: CSA (threshold, MTA, initial/variation margin), variation daily (reduces exposure to ~$0), MPOR = 10 days (exposure if counterparty defaults during margin period)',
            'Wrong-way risk: Protection on correlated entity (sell CDS on Bank A to Bank A), distress = spread widens + counterparty defaults, avoid or charge premium, extra collateral',
            'Netting: Bilateral netting (net all trades with counterparty), reduces exposure 70-90%, legal (ISDA Master), regulatory (Basel III recognizes), CCP clearing (no bilateral risk)',
            'SA-CCR: EAD = 1.4×(RC+PFE), RC = max(MTM-collateral, 0), PFE = 0.5%×Notional×Maturity_factor, RWA = EAD×100% bilateral (2% cleared), capital = 8%×RWA',
        ],
    },
];

