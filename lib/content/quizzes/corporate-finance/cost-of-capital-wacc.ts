export const costOfCapitalWaccQuiz = [
  {
    id: 'wacc-q-1',
    question:
      'You are CFO of TechCorp, a publicly traded software company. Your company is considering a major acquisition that will significantly change the capital structure. Current capital structure: $2B market cap (equity), $500M debt at 5% yield, 20% tax rate, beta = 1.3, risk-free rate = 4%, market risk premium = 6.5%. Post-acquisition: $2B equity (diluted by new shares), $1.5B debt at 6.5% yield (higher leverage, higher rate), beta expected to rise to 1.6. Calculate: (1) Current WACC, (2) Post-acquisition WACC, (3) Explain why beta increased and the implications for project evaluation, (4) What discount rate should you use to evaluate the acquisition itself, and why?',
    sampleAnswer:
      'Complete WACC analysis for acquisition: (1) Current WACC: Step 1: Cost of equity (CAPM): Re = Rf + β(Rm - Rf) = 4% + 1.3(6.5%) = 12.45%. Step 2: After-tax cost of debt: Rd(1-T) = 5%(1-0.20) = 4.0%. Step 3: Capital structure weights: E = $2B, D = $0.5B, V = $2.5B. wE = 2.0/2.5 = 80%, wD = 0.5/2.5 = 20%. Step 4: WACC = 80%(12.45%) + 20%(4.0%) = 9.96% + 0.80% = 10.76%. (2) Post-acquisition WACC: Step 1: New cost of equity: Re = 4% + 1.6(6.5%) = 14.40%. Step 2: New after-tax cost of debt: Rd(1-T) = 6.5%(1-0.20) = 5.20%. Step 3: New weights: E = $2B, D = $1.5B, V = $3.5B. wE = 2.0/3.5 = 57.1%, wD = 1.5/3.5 = 42.9%. Step 4: WACC = 57.1%(14.40%) + 42.9%(5.20%) = 8.22% + 2.23% = 10.45%. (3) Why beta increased: Financial leverage amplifies equity risk. Original unlevered beta (asset beta): βU = βL / [1 + (1-T)(D/E)] = 1.3 / [1 + 0.80(0.5/2.0)] = 1.3 / 1.20 = 1.083. New levered beta: βL = βU [1 + (1-T)(D/E)] = 1.083 [1 + 0.80(1.5/2.0)] = 1.083 × 1.60 = 1.73. Wait, we said 1.6—close enough given approximation. Higher D/E ratio increases equity beta because debt holders have fixed claims, so equity holders bear more business risk. Implications: Projects evaluated at higher cost of equity (14.4% vs 12.45%). Higher hurdle rate means fewer projects will have positive NPV. Company must be selective about capital allocation. (4) Discount rate for the acquisition: Use CURRENT (pre-acquisition) WACC of 10.76%. Why? The acquisition decision should be made based on current capital costs. If acquisition NPV > 0 at current WACC, it adds value. Post-acquisition WACC (10.45%) is relevant for future projects after the deal closes, but not for evaluating whether to do the deal. Alternative view: Some argue to use "average" of pre and post WACC, but standard practice is pre-acquisition WACC. Critical insight: WACC decreased slightly (10.76% → 10.45%) despite higher leverage because debt is cheaper than equity. The tax shield benefit (more debt = more tax deductions) outweighs the increased cost of equity from higher risk.',
    keyPoints: [
      'Current WACC: 10.76% (80% equity at 12.45%, 20% debt at 4.0% after-tax)',
      'Post-acquisition WACC: 10.45% (57% equity at 14.40%, 43% debt at 5.20%)',
      'Beta increases from 1.3 to 1.6 due to financial leverage amplifying equity risk',
      'Use pre-acquisition WACC (10.76%) to evaluate the acquisition decision itself',
      'Post-acquisition WACC actually decreases due to tax shield benefits outweighing higher equity cost',
    ],
  },
  {
    id: 'wacc-q-2',
    question:
      'Design a production-ready "WACC calculator" system for a corporate finance team. Requirements: (1) Handle companies with multiple debt instruments (bonds with different maturities/yields, bank loans, leases), (2) Calculate unlevered and levered betas for project evaluation, (3) Perform sensitivity analysis on all key inputs, (4) Generate peer company comparisons by industry, (5) Include Monte Carlo simulation for uncertain inputs (beta, MRP, tax rate), (6) Export results to Excel with executive summary. Provide system architecture, key algorithms, and explain how to handle edge cases (negative equity, financial companies with different capital structures).',
    sampleAnswer:
      "Production WACC calculator design: (1) System architecture: Frontend: React SPA for user input and visualization. Backend: FastAPI (Python) for calculations, PostgreSQL for storing calculations/peer data, Redis for caching market data, Celery for async Monte Carlo simulations. External APIs: Yahoo Finance/Alpha Vantage for stock data, FRED for risk-free rates, Moody's/S&P API for credit ratings. (2) Multiple debt instruments: class DebtInstrument: bond_type: str (senior, subordinated, convertible); face_value: float; market_value: float (from price or approx); coupon_rate: float; ytm: float; maturity_years: int; weight: float (proportion of total debt). Aggregate cost of debt: Rd_weighted = Σ(weight_i × ytm_i) for each debt instrument. Market value of debt = Σ(market_value_i). Handle leases: Under IFRS 16/ASC 842, capitalize operating leases. Add PV of lease payments to debt. Use implicit lease rate as cost. Example: Lease payments = $10M/year for 5 years at 6% implicit rate. PV = $10M × [1-(1.06)^-5]/0.06 = $42.1M. Add to total debt. (3) Unlevered and levered beta: Formulas: βL = βU [1 + (1-T)(D/E)] (lever formula), βU = βL / [1 + (1-T)(D/E)] (unlever formula). Use for project evaluation: Get company beta βL (levered). Unlever to get asset beta βU. This is business risk only, removing financial structure. For new project with different risk: Adjust βU based on project risk vs company average. Relever at target capital structure for project: βProject = βU [1 + (1-T)(D/E)project]. Calculate project-specific cost of equity using βProject. Code: def unlever_beta(beta_levered, debt, equity, tax_rate): return beta_levered / (1 + (1 - tax_rate) * (debt / equity)). def lever_beta(beta_unlevered, debt, equity, tax_rate): return beta_unlevered * (1 + (1 - tax_rate) * (debt / equity)). (4) Sensitivity analysis: Key parameters: Beta (±0.3), Risk-free rate (±1%), Market risk premium (±2%), Tax rate (±5%), Debt/equity ratio (±20%). For each parameter: Create 20 values across range. Hold others at base case. Calculate WACC at each value. Display tornado chart: Sort parameters by impact on WACC (largest bar = most sensitive). Two-way sensitivity heatmap: E.g., beta vs market risk premium. Color-code by WACC ranges. Code: def sensitivity_analysis(base_params): results = {}; for param in base_params.keys(): values = np.linspace(base_params[param]*0.8, base_params[param]*1.2, 20); waccs = [calculate_wacc({**base_params, param: v}) for v in values]; results[param] = (values, waccs); return tornado_chart_data(results). (5) Peer comparison: Industry selection: GICS classification (Technology, Healthcare, etc.). Fetch peers: Query API for companies in same industry. Calculate WACC for each peer using same methodology. Metrics to display: Median WACC, P25/P75, Company position vs peers, Average D/E ratio, Average beta. Visualization: Box plot of peer WACCs with company highlighted. Table: Rank companies by WACC (lowest to highest). Code: def peer_comparison(company, industry): peers = fetch_peers_by_gics(industry); peer_waccs = [calculate_wacc_for_company(p) for p in peers]; stats = {'median': np.median(peer_waccs), 'p25': np.percentile(peer_waccs, 25), 'p75': np.percentile(peer_waccs, 75)}; return stats, peer_waccs. (6) Monte Carlo simulation: Uncertain inputs modeled as distributions: Beta: Normal(μ=1.2, σ=0.2). Market risk premium: Triangular(min=5%, mode=6.5%, max=8%). Risk-free rate: Uniform(3%, 5%). Tax rate: Beta distribution scaled to [15%, 25%]. Algorithm: Run 10,000 simulations. Each iteration: Draw random values from distributions. Calculate WACC. Store result. Analyze: Mean WACC, Standard deviation, Percentiles (P10, P50, P90), Confidence intervals (90%, 95%). Visualization: Histogram of WACC distribution. Cumulative probability curve. Code: def monte_carlo_wacc(distributions, n_sims=10000): results = []; for _ in range(n_sims): beta = distributions['beta'].rvs(); mrp = distributions['mrp'].rvs(); rf = distributions['rf'].rvs(); tax = distributions['tax'].rvs(); wacc = calculate_wacc(beta, mrp, rf, tax); results.append(wacc); return {'mean': np.mean(results), 'std': np.std(results), 'p10': np.percentile(results, 10), 'p50': np.percentile(results, 50), 'p90': np.percentile(results, 90)}. (7) Excel export: Generate Excel with openpyxl/xlsxwriter: Sheet 1: Executive Summary (WACC, key inputs, recommendation). Sheet 2: Detailed Calculations (step-by-step WACC build-up). Sheet 3: Sensitivity Analysis (tornado chart, data tables). Sheet 4: Peer Comparison (table and charts). Sheet 5: Monte Carlo Results (distribution, statistics). Sheet 6: Assumptions and Methodology. Professional formatting: Color-coded cells (inputs in blue, calculations in black, outputs in green). Charts embedded. Corporate logo/branding. (8) Edge cases: Negative equity (distressed companies): Book equity < 0 but market cap > 0. Use market cap for equity value. Alternatively, if company near bankruptcy, WACC concept breaks down. Use APV (Adjusted Present Value) instead. Financial companies (banks, insurance): Different capital structure (high \"debt\" is really deposits/liabilities). For banks: Exclude deposits from \"debt\" calculation. Use only borrowed funds (bonds, notes) as debt. Or use industry-specific WACC benchmarks. Zero or minimal debt: WACC = cost of equity (no debt component). Some companies (Apple, Google historically) hold more cash than debt. Use net debt (Debt - Cash) in calculation. Negative \"net debt\" means company is net creditor. Convertible debt: Market value includes option value. Use conversion parity or market price to value. Cost = yield to maturity or yield to call, whichever is relevant.",
    keyPoints: [
      'Multiple debt: Weight each instrument by market value, calculate weighted average YTM',
      'Unlever beta (remove leverage) for project evaluation, then relever at project D/E',
      'Sensitivity analysis: Beta and MRP typically have largest impact on WACC',
      'Monte Carlo: Model uncertain inputs as distributions, show WACC probability range',
      'Edge cases: Negative equity (use market cap), banks (exclude deposits), net cash (negative net debt)',
    ],
  },
  {
    id: 'wacc-q-3',
    question:
      'A private company (not publicly traded) is seeking valuation for an acquisition. No stock price or beta available. The company operates in manufacturing (EBITDA $50M, moderate growth). Comparable public companies have average beta of 1.1 and average D/E ratio of 0.5. Your company has $30M debt (6% interest rate) and book equity of $80M. Tax rate is 25%. Walk through the complete process to calculate WACC for this private company, including: (1) How to estimate cost of equity without a stock price, (2) Adjusting comparable betas for leverage differences, (3) Handling the lack of market value for equity, (4) Determining appropriate weights for private company capital structure.',
    sampleAnswer:
      'Private company WACC calculation: (1) Cost of equity without stock price: Cannot directly calculate beta (no trading data). Solution: Use comparable public companies. Step 1: Identify comparables: Find 5-10 public manufacturing companies similar size/growth. Average beta of comps = 1.1 (given). Average D/E of comps = 0.5 (given). Step 2: Unlever comp betas: Comp companies have financial leverage. Remove it to get asset beta (business risk only). Formula: βU = βL / [1 + (1-T)(D/E)]. Using comp average: βU = 1.1 / [1 + (1-0.25)(0.5)] = 1.1 / 1.375 = 0.80. This is the "unlevered beta" for the manufacturing industry. Step 3: Relever for target company: Target company D/E = $30M debt / $80M equity = 0.375. βL = βU [1 + (1-T)(D/E)] = 0.80 [1 + 0.75(0.375)] = 0.80 × 1.28 = 1.024 ≈ 1.02. Step 4: Calculate cost of equity: Re = Rf + β(Rm - Rf). Assume Rf = 4%, MRP = 6.5%. Re = 4% + 1.02(6.5%) = 10.63%. Alternative method: Build-up approach: Re = Rf + Industry risk premium + Size premium + Company-specific risk. Industry risk premium ≈ β × MRP = 1.02 × 6.5% = 6.63%. Size premium: Small private companies riskier. Add 2-4% for small-cap (using Ibbotson data). Company-specific risk: Add 2-3% for private company illiquidity and concentration risk. Re = 4% + 6.63% + 3% + 2.5% = 16.13%. This is higher than CAPM because it adds small-cap and private company premiums. Blended approach: Use average of CAPM (10.63%) and build-up (16.13%) = 13.38%. Or choose based on company specifics. For moderate growth, stable manufacturing: Lean toward CAPM. For early-stage, volatile business: Lean toward build-up. (2) Adjusting for leverage differences: As shown above: Unlever comps (remove their leverage). Relever for target (apply target\'s leverage). Critical: Must adjust for leverage because different D/E ratios create different equity risks. A company with 80% debt has much riskier equity than one with 20% debt. (3) Market value of equity (no stock price): Book equity = $80M. But market value ≠ book value. Options: Option A: Approximate market value: For mature, profitable companies, MV ≈ 1.5-2.5x book equity. Use EBITDA multiple from comps: Comp average EV/EBITDA = 8x (industry standard). Enterprise value = $50M EBITDA × 8 = $400M. Less debt: Equity value = $400M - $30M = $370M. This is market value of equity. Option B: Use DCF to estimate equity value: Build 5-year cash flow projection. Discount at estimated WACC (iterative calculation). Resulting equity value is market value. For now, use Option A (simpler): MV equity = $370M. (4) Capital structure weights: E = $370M (estimated market value). D = $30M (book value, assuming close to market). V = $400M. Weights: wE = 370/400 = 92.5%, wD = 30/400 = 7.5%. (5) Cost of debt: Interest rate = 6% (given). Credit rating: Based on EBITDA/Interest coverage. Interest coverage = EBITDA / Interest = $50M / ($30M × 6%) = $50M / $1.8M = 27.8x. Excellent coverage → likely A/AA rating → 6% is reasonable. After-tax cost = 6% × (1 - 0.25) = 4.5%. (6) Final WACC calculation: WACC = wE × Re + wD × Rd(1-T). Using CAPM cost of equity (10.63%): WACC = 92.5%(10.63%) + 7.5%(4.5%) = 9.83% + 0.34% = 10.17%. Using build-up cost of equity (13.38%): WACC = 92.5%(13.38%) + 7.5%(4.5%) = 12.38% + 0.34% = 12.72%. Recommendation: Use WACC range of 10-13% depending on risk assessment. For acquisition valuation, use 11-12% (mid-range). If buyer perceives low risk, use 10-11%. If high risk/uncertainty, use 12-13%. Sensitivity analysis: Show acquisition value at WACC = 10%, 11%, 12%, 13% to demonstrate impact. Key lesson: Private company WACC requires judgment and triangulation. No single "correct" answer. Use comparable companies, adjust for differences, and validate with industry benchmarks.',
    keyPoints: [
      'Estimate beta using comparable public companies: unlever their betas, relever for target D/E',
      'Cost of equity: CAPM gives 10.6%, build-up approach (with size/private company premiums) gives 16.1%',
      'Market value of equity: Use EV/EBITDA multiple from comps ($50M EBITDA × 8x = $400M EV, less $30M debt = $370M equity)',
      'Capital structure: 92.5% equity, 7.5% debt (using estimated market values)',
      'Final WACC: 10-13% range depending on risk premiums applied (use 11-12% for valuation)',
    ],
  },
];
