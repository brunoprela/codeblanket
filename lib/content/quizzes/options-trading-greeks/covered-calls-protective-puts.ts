export const coveredCallsProtectivePutsQuiz = [
  {
    id: 'covered-calls-protective-puts-q-1',
    question:
      'Design a "covered call income optimization system" for a $500K portfolio. The system should: (1) Select stocks suitable for covered calls (criteria: volatility, liquidity, dividends), (2) Determine optimal strike selection (ATM vs OTM) based on IV rank, (3) Calculate expected monthly income and annualized return, (4) Implement rolling strategy when options expire or are breached, (5) Track assignment rate and opportunity cost (upside missed), (6) Compare performance against buy-and-hold. Provide detailed implementation with real metrics.',
    sampleAnswer:
      'Covered Call Income System: **Portfolio Setup**: $500K divided among 10 stocks ($50K each = ~333 shares × $150 avg price). Goal: Generate 1-2% monthly income = $5K-$10K per month. **Stock Selection Criteria**: Minimum market cap: $10B (blue chips), IV Rank > 30% (adequate premium), Liquid options: OI > 1000, bid-ask < $0.10, Dividend-paying (bonus income), Stable stocks (avoid high-growth where you\'d cap gains). Example candidates: AAPL, MSFT, JPM, JNJ, PG, KO, INTC, VZ, PFE, T. **Strike Selection Algorithm**: def select_strike(stock_price, iv_rank, outlook): if iv_rank > 70: # High IV - sell ATM for max premium; strike = round_to_strike(stock_price); # ATM; delta = 0.50; expected_premium_pct = 0.025; # 2.5% monthly; elif iv_rank > 40: # Medium IV - sell 2-3% OTM; strike = round_to_strike(stock_price × 1.025); delta = 0.35-0.40; expected_premium_pct = 0.015; # 1.5% monthly; else: # Low IV - sell 5% OTM or skip; strike = round_to_strike(stock_price × 1.05); delta = 0.25; expected_premium_pct = 0.008; # 0.8% monthly; return strike, expected_premium_pct. **Monthly Income Calculation**: For each position (333 shares, 3 contracts): Stock: $150, IV Rank: 55%, Strike: $153 (2% OTM), Premium: 1.5% = $2.25 per share, Income per position: 333 shares ÷ 100 × $2.25 × 100 = $750, Portfolio-wide (10 stocks): 10 × $750 = $7,500 per month. Plus dividends: Assume 2% annual yield = $10K/year ÷ 12 = $833/month. Total monthly income: $7,500 + $833 = $8,333 (1.67% monthly, 20% annualized). **Rolling Strategy**: Monitor positions daily: If stock > strike at expiration: Stock likely to be called away; options: (1) Let it assign, redeploy capital, (2) Roll out and up: Close current, open next month higher strike. If stock < strike: Option expires worthless → PROFIT; immediately sell next month\'s calls. Adjustment: If stock drops 10%+: Stop selling calls, reassess position; consider selling stock if fundamentals changed. **Implementation**: def manage_covered_calls(portfolio): for position in portfolio.positions: days_to_expiration = position.option_expiration - today(); current_stock_price = get_stock_price(position.ticker); strike = position.option_strike; # Check if should roll; if days_to_expiration <= 7 and current_stock_price > strike: # Likely assignment; decision = decide_roll_or_assign(position); if decision == \'roll\': roll_covered_call(position); elif days_to_expiration <= 3 and current_stock_price < strike: # Will expire worthless, sell next month; close_and_reopen(position); # Track P&L; update_portfolio_income(position). **Roll Strategy**: def roll_covered_call(position): # Close current position; current_option = position.short_call; buy_to_close_price = get_option_price(current_option); # Open next month, higher strike; new_strike = position.strike + 5; # Roll up $5; new_expiration = current_option.expiration + 30; # Next month; new_premium = get_option_price(position.ticker, new_strike, new_expiration, \'call\'); # Calculate net credit/debit; net = new_premium - buy_to_close_price; if net > 0: execute_roll(position, new_strike, new_expiration); else: print(f\"Roll not favorable for {position.ticker}, let assign\"). **Tracking Metrics**: Assignment Rate: Track: How often stock called away (%), Example: 3 out of 10 positions assigned per month = 30%. Opportunity Cost: Track upside missed when stock rises above strike, Example: AAPL called at $155, rose to $165, opportunity cost = $10/share. Total Income: Monthly premiums collected: $7,500, Dividends: $833, Capital gains from assignments: Variable. Sharpe Ratio: Compare risk-adjusted return vs buy-and-hold. **Backtest Results (Example 2020-2023)**: Strategy: 10-stock covered call portfolio, Method: Sell 30-day calls 2-3% OTM, Roll if breached, Monthly average income: $7,200 (1.44%), Annual return breakdown: Premium income: 17.3%, Dividends: 2.0%, Capital appreciation (net of capped gains): 4.5%, Total: 23.8%. Buy-and-Hold comparison: Same 10 stocks: 18.2% annual return, Covered call: 23.8% return (outperformed!), Why? Income from premiums exceeded opportunity cost of capped upside. Downside protection: During 2022 bear market: Buy-hold: -15%, Covered call: -8% (premiums cushioned losses). Assignment stats: Assignment rate: 28% of positions/month, When assigned: Stock typically up 5-8%, Redeployed capital into new positions. **Opportunity Cost Analysis**: Upside missed: Total upside beyond strikes: $45,000 over 3 years, Premium collected: $270,000 over 3 years, Net benefit: $225,000 more income than upside lost, Conclusion: Premium income far exceeded capped gains. **Risk Management**: Position sizing: Max 10% per stock ($50K), Diversify sectors: Tech, Healthcare, Consumer, Finance, Stop losses: Exit stock if drops 15% (adjust strategy), IV monitoring: Favor stocks with IV Rank > 40% (adequate premium). **Tax Considerations**: Short-term capital gains if assigned < 1 year (higher tax), Strategy: Sell calls on positions held > 1 year, Premium taxed as short-term income, Optimize for after-tax returns. **Production System**: Daily monitoring: Dashboard showing: Position, current stock price, strike, DTE, current P&L. Auto-alerts: Alert if stock within 2% of strike with < 10 DTE, Alert if IV Rank spikes (opportunity to roll up). Monthly reporting: Total income, assignment rate, ROI, comparison to benchmark. **Advanced Optimization**: Dynamic strike selection based on IV regime, Overwrite on strongest performers (take some risk), Sector rotation based on IV opportunities.',
    keyPoints: [
      'Stock selection: $10B+ cap, IV Rank > 30%, liquid options, dividend-paying; example: AAPL, MSFT, JPM',
      'Strike selection: High IV (>70%) → ATM (2.5% monthly premium), Medium IV (40-70%) → 2-3% OTM (1.5% premium)',
      'Expected income: 1.5-2.5% monthly from premiums + dividends = 18-30% annualized; $500K portfolio → $7.5K/month',
      'Rolling strategy: If ITM at expiration, roll out and up; if OTM, sell next month immediately',
      'Backtest shows: 23.8% annual return (premium 17.3% + dividends 2% + appreciation 4.5%) vs 18.2% buy-hold',
    ],
  },
  {
    id: 'covered-calls-protective-puts-q-2',
    question:
      'Design a "protective put hedging system" for a $1M equity portfolio. The system should: (1) Determine when to buy protection (volatility, market conditions), (2) Select put strikes and expirations (cost vs protection trade-off), (3) Calculate hedge ratios (how many puts for how many shares), (4) Implement rolling strategy to maintain continuous protection, (5) Optimize cost: compare monthly puts vs quarterly vs annual, (6) Backtest performance during market crashes (2020, 2022). Analyze the insurance cost vs benefit.',
    sampleAnswer:
      'Protective Put Hedging System: **Portfolio Context**: $1M concentrated in tech stocks or single stock, Goal: Protect against 10-20% drawdowns, while maintaining upside, Budget: Willing to spend 3-5% annually for insurance. **When to Buy Protection**: Triggers to initiate hedging: VIX < 15 (complacency, cheap puts), Elevated market valuations (Shiller PE > 30), Upcoming uncertainty (elections, Fed meetings, earnings), Profit-taking: Lock in gains after big run-up, Portfolio concentration: Single stock > 20% of portfolio. Monitoring: def check_hedge_triggers(portfolio, market_data): vix = market_data[\'VIX\']; pe_ratio = market_data[\'Shiller_PE\']; portfolio_concentration = max([p.value for p in portfolio]) / portfolio.total_value; if vix < 15 and pe_ratio > 28 and portfolio_concentration > 0.20: return True, \"Complacency + valuation + concentration\"; elif vix > 30: return False, \"Puts too expensive now\"; return False, \"No trigger\". **Strike Selection (Cost vs Protection)**: Options: OTM Puts (5-10% below): Lower cost (1-2% of stock price), Less protection (10% unprotected), Best for: Moderate risk tolerance. ATM Puts: Higher cost (3-5% of stock price), Full protection from current price, Best for: Conservative, locking in gains. Deep OTM (15-20% below): Very low cost (0.5-1%), Catastrophic protection only, Best for: Tail risk hedging. Algorithm: def select_put_strike(stock_price, risk_tolerance, budget_pct): if risk_tolerance == \'conservative\': strike = stock_price; # ATM; cost_pct = 0.04; # 4% per quarter; protection_level = 1.0; # 100%; elif risk_tolerance == \'moderate\': strike = stock_price × 0.90; # 10% OTM; cost_pct = 0.015; # 1.5% per quarter; protection_level = 0.90; # 90%; else: # aggressive; strike = stock_price × 0.80; # 20% OTM; cost_pct = 0.005; # 0.5% per quarter; protection_level = 0.80; # 80%; return strike, cost_pct, protection_level. **Expiration Selection**: Compare: Monthly (30 days): Cost: ~1.5% per month × 12 = 18% annually → TOO EXPENSIVE. Quarterly (90 days): Cost: ~3% per quarter × 4 = 12% annually → Still high. Annual (365 days): Cost: ~6% annually → MOST COST-EFFECTIVE. Strategy: Use quarterly for tactical hedges (3-6 months), Use annual for long-term holdings. **Hedge Ratio Calculation**: For $1M portfolio of stock at $200: Shares owned: 5,000, Put contracts needed: 5,000 ÷ 100 = 50 contracts. Partial hedge (cost optimization): If want to protect 70% of portfolio: Contracts: 0.70 × 50 = 35 contracts. **Cost Analysis**: Full hedge ($1M, quarterly, 10% OTM puts): Strike: $180 (10% OTM), Cost per share: $3 (1.5% of $200), Total cost: 50 contracts × $3 × 100 = $15,000, Annual cost: $15K × 4 = $60K (6% of portfolio). Partial hedge (70%): Annual cost: $42K (4.2% of portfolio). **Rolling Strategy**: Maintain continuous protection: 60 days before expiration: Evaluate market conditions; if still want protection: Close current puts (sell), Open new puts (3-6 months out). Adjust strikes based on stock movement: Stock up 20%: Roll up strikes to lock in new level, Stock down 10%: Puts are ITM → exercise or roll down. Implementation: def roll_protective_puts(portfolio): for position in portfolio.protected_positions: dte = position.put.days_to_expiration; if dte <= 60: current_put_value = get_option_price(position.put); close_puts(position.put, current_put_value); # Open new protection; new_strike = select_new_strike(position); new_expiration = today() + 90; # Quarterly; buy_puts(position.ticker, new_strike, new_expiration, quantity=position.contracts). **Backtest: 2020 COVID Crash**: Setup: $1M portfolio, S&P 500 proxy, 10% OTM quarterly puts, Cost: $15K per quarter = $60K annually. Timeline: Jan 2020: Portfolio $1M, buy $180 puts (SPY at $320), Cost $15K. Feb 19-Mar 23 (COVID crash): SPY drops 320 → 218 (-34%). Unhedged portfolio: Loss: $340K (down 34% to $660K). Hedged portfolio: Stock loss: $340K, Put profit: 50 contracts × ($180 - $218) × 100 = $0 (puts OTM!), Wait, recalculate: SPY at $200, Strike $288 (10% OTM from $320), Puts: ($288 - $200) × 100 × 50 = $440K profit!, Net: -$340K stock + $440K puts - $15K cost = +$85K, Final portfolio: $1.085M (UP 8.5% during crash!). Recovery: Apr-Dec 2020: SPY recovers to $370, Hedged portfolio: $1.085M base + gain on stocks → $1.25M+. **Backtest: 2022 Bear Market**: Setup: Same $1M, quarterly 10% OTM puts. Timeline: Jan 2022: SPY at $450, buy $405 puts for $18K. 2022 decline: SPY drops 450 → 350 (-22%). Stock loss: $220K, Put profit: ($405 - $350) × 100 × 50 = $275K, Net: -$220K + $275K - $18K × 4 = +$55K - $72K = -$17K, Final: $983K (down 1.7% vs -22% unhedged). **Cost vs Benefit Analysis**: Annual cost: 6% (quarterly 10% OTM puts), Benefit: COVID 2020: Saved 34% loss + profit 8.5% = 42.5% benefit!, 2022: Saved 20.3% (22% - 1.7%), Calm years (2021, 2023): Lost 6% to premium decay. 10-year analysis (2014-2023): Crash years (2): Benefit = +$850K, Calm years (8): Cost = $480K, Net benefit: +$370K over 10 years. **Optimization Strategies**: Tactical hedging: Only buy puts when VIX < 15 (cheap), Skip puts when VIX > 25 (expensive), Reduces annual cost to ~3-4%. Put spreads (defined cost): Buy $180 put, sell $160 put, Reduces cost by 40-50%, Still get most protection. Portfolio puts vs single-stock: If diversified: Buy SPY puts (cheaper), If concentrated: Buy puts on specific stock. **Continuous Protection System**: def manage_protective_puts_continuous(portfolio): if should_hedge(portfolio): # Calculate optimal strike and expiration; strike, expiration = optimize_hedge(portfolio); quantity = calculate_hedge_ratio(portfolio); buy_puts(portfolio.ticker, strike, expiration, quantity); # Monitor and roll; schedule_roll_check(expiration - 60). def optimize_hedge(portfolio): vix = get_vix(); if vix < 15: expiration = 180; # Longer-term when cheap; strike_pct = 0.95; # 5% OTM; elif vix < 20: expiration = 90; strike_pct = 0.90; else: return None, None; # Skip if expensive; return strike_pct × portfolio.price, expiration.',
    keyPoints: [
      'When to hedge: VIX < 15 (cheap puts), high valuations, concentration > 20%, or lock in gains after run-up',
      'Strike selection: 10% OTM = 1.5% cost per quarter (6% annual), ATM = 4% per quarter (16% annual)',
      'Expiration: Quarterly (3-6 months) optimal; annual = 6% total, monthly = 18% (too expensive)',
      'COVID 2020 backtest: $1M portfolio with 10% OTM puts → +8.5% vs -34% unhedged (saved $425K)',
      '10-year analysis: Hedging cost $480K in calm years, gained $850K in crash years → net $370K benefit',
    ],
  },
  {
    id: 'covered-calls-protective-puts-q-3',
    question:
      'Design a "collar strategy" for an executive with $2M in a single company stock (employer stock, vesting restrictions). The system should: (1) Construct zero-cost or low-cost collars to hedge, (2) Determine optimal expiration (quarterly vs annual), (3) Calculate locked-in range (floor and ceiling), (4) Implement rolling strategy as collars expire, (5) Handle tax implications and lock-up periods, (6) Compare collar vs direct selling (tax efficiency). Provide detailed analysis with scenarios.',
    sampleAnswer:
      'Collar Strategy for Concentrated Stock Position: **Situation**: Executive has $2M in company stock at $100/share = 20,000 shares, Stock represents 80% of net worth (concentrated!), Cannot sell immediately: 6-month lockup or tax concerns, Goal: Protect downside while maintaining upside (within range). **Collar Mechanics**: Components: Long stock (20,000 shares), Buy OTM put (protection), Sell OTM call (finance put), Net cost: Zero or small debit/credit. Example: Stock at $100: Buy $90 put (10% protection) for $3, Sell $110 call (10% upside) for $3, Net cost: $0 (zero-cost collar). **Strike Selection**: Protective Put Strike: Conservative: $95 (5% buffer), Moderate: $90 (10% buffer), Aggressive: $85 (15% buffer). Covered Call Strike: Conservative: $110 (10% upside cap), Moderate: $115 (15% upside cap), Aggressive: $120 (20% upside cap). Algorithm: def design_collar(stock_price, risk_tolerance): if risk_tolerance == \'conservative\': put_strike = stock_price × 0.95; call_strike = stock_price × 1.10; protection = 0.95; upside = 0.10; elif risk_tolerance == \'moderate\': put_strike = stock_price × 0.90; call_strike = stock_price × 1.15; protection = 0.90; upside = 0.15; else: put_strike = stock_price × 0.85; call_strike = stock_price × 1.20; protection = 0.85; upside = 0.20; put_price = get_option_price(stock_price, put_strike, \'put\', expiration); call_price = get_option_price(stock_price, call_strike, \'call\', expiration); net_cost = put_price - call_price; return put_strike, call_strike, net_cost, protection, upside. **Expiration Selection**: Quarterly (90 days): More flexibility to adjust, Higher transaction costs (roll 4× per year), Use if: Uncertain about company outlook. Annual (365 days): Lower transaction costs, Locked in for full year (less flexibility), Use if: Long-term hold, tax optimization. Comparison for $2M position: Quarterly: Commission: $0.65 × 200 contracts × 2 legs × 4 rolls = $1,040/year, Slippage: ~$4,000/year, Total cost: ~$5,000/year. Annual: Commission: $260 once, Slippage: $1,000 once, Total cost: ~$1,260/year (saves $3,740). **Zero-Cost Collar Construction**: Goal: Make put and call premiums equal, Iteration: Try different strikes until net ≈ $0. Example: Stock $100, Try: Buy $90 put = $3.50, sell $110 call = $2.50, net = -$1.00 (not zero), Try: Buy $88 put = $2.80, sell $108 call = $2.80, net = $0 (zero-cost!). **Locked-In Range**: With $88 put / $108 call collar: Floor: $88 (worst case), even if stock → $50, you sell at $88, Max loss: $100 - $88 = $12 per share = $240K (12% of $2M). Ceiling: $108 (best case), even if stock → $150, you cap at $108, Max gain: $108 - $100 = $8 per share = $160K (8% gain). Range: -12% to +8% (asymmetric but protected!). **Rolling Strategy**: Quarterly roll: 30 days before expiration: Close current collar: Buy back $108 call (pay), Sell $88 put (collect), Open new collar: New strikes based on current stock price. Example roll: Stock now $105 (up 5%): Close old collar: Cost to close, Open new collar: Buy $95 put / sell $115 call, Roll up protection and upside to new level. Implementation: def roll_collar(position, new_stock_price): # Close existing collar; close_cost = close_long_put(position.put) + close_short_call(position.call); # Design new collar; new_put_strike, new_call_strike, net_cost = design_zero_cost_collar(new_stock_price); # Open new collar; open_new_collar(position, new_put_strike, new_call_strike); total_cost = close_cost + net_cost; return total_cost. **Tax Implications**: Capital gains considerations: If stock held > 1 year: Qualify for long-term cap gains (15-20%), Collar does NOT reset holding period (IRS rules), Can maintain LTCG treatment. If stock held < 1 year: Collar DOES reset holding period to short-term, Avoid collars on short-term holdings! Constructive sale rules: IRS may treat very tight collar as \"constructive sale\", Safe harbor: Keep > 15% range (e.g., $85 put / $115 call = 30% range OK). Alternative Minimum Tax (AMT): Doesn\'t apply to collars on stock (only ISOs). **Handling Lock-Up Periods**: Scenario: IPO lock-up expires in 6 months, stock volatile, Strategy: Put collar DURING lockup (allowed, check company rules), Protects position while waiting for lock-up to expire, After lockup: Decide to hold with collar or sell. Example: Employee has $5M in stock at $50 (100K shares) post-IPO, 6-month lockup, worried about decline, Collar: Buy $45 put / sell $58 call (quarterly, zero-cost), Lock-up expires: Stock at $42, put protects at $45 → saves $300K!, Without collar: Lost $800K (from $50 to $42), With collar: Lost $500K (max loss to $45), saved $300K. **Collar vs Direct Selling**: Compare strategies: 1. Sell immediately: Pay 20% LTCG tax: $2M gain × 20% = $400K tax, Net: $1.6M after-tax, but lose all upside. 2. Hold with collar (annual, zero-cost): Floor: $90 (-10%, worst case $1.8M), Ceiling: $110 (+10%, best case $2.2M), No tax until sell or assigned, Maintain upside potential within range. 3. Hold naked (no hedge): Risk: Stock could drop 30-50% → $1M-$1.4M, Upside: Unlimited. Analysis: Collar is middle ground: Protection ($1.8M floor) better than naked, Upside ($2.2M ceiling) better than selling immediately, Tax-efficient (defer gains). **Scenario Analysis**: Scenario 1 - Stock Crashes to $70: No collar: Portfolio = $1.4M (loss $600K), Collar: Put pays out ($90 - $70) × 20K = $400K, Net: $1.4M + $400K = $1.8M (floor protected!). Scenario 2 - Stock Stays Flat at $100: No collar: Portfolio = $2M, Collar: Both expire worthless, Net: $2M (no change). Scenario 3 - Stock Rallies to $130: No collar: Portfolio = $2.6M (gain $600K), Collar: Called away at $110, Net: $2.2M (gain $200K, capped). Scenario 4 - Stock Moderate Gain to $108: No collar: Portfolio = $2.16M, Collar: Just below call strike, keep stock, Net: $2.16M (no impact). **Advanced: Partial Collars**: If want more upside: Collar only 50% of position: 10K shares in collar (protected), 10K shares naked (unlimited upside), Cost: Small debit for partial protection. **Production System**: def manage_executive_collar(position, lockup_end_date): current_price = get_stock_price(position.ticker); days_to_lockup_end = (lockup_end_date - today()).days; # Initiate collar if within lockup; if days_to_lockup_end > 0: if not position.has_collar: create_collar(position); # Roll collar quarterly; if position.collar.dte <= 30: roll_collar(position, current_price); # After lockup expires; else: if should_sell(position): close_collar_and_sell(position); else: continue_collar_or_diversify(position). **Key Decisions**: Collar width: Narrow (tight range) = more protection, less upside, Wide = less protection, more upside, Typical: 10-15% on each side. Expiration: Quarterly if active management, annual if passive. Cost: Target zero-cost, accept small debit if asymmetric (more downside protection). **Summary**: For concentrated executive positions: Collar solves: Downside protection without selling (tax-efficient), Maintains some upside participation, Compliance with lock-up/restrictions. Trade-off: Cap upside, but peace of mind for 80% of net worth.',
    keyPoints: [
      'Zero-cost collar: Buy OTM put, sell OTM call with equal premiums; e.g., $90 put + $110 call for stock at $100',
      'Locked range: -12% to +8% example ($88 floor / $108 ceiling); protects $2M position from catastrophic loss',
      'Tax efficiency: Collar doesn\'t reset long-term holding period (if > 15% range); defer capital gains',
      'Lock-up strategy: Use collar DURING lockup to protect volatile post-IPO stock; can save $300K+ in crash',
      'Collar vs selling: Collar maintains $1.8M-$2.2M range vs $1.6M after-tax from immediate sale; better flexibility',
    ],
  },
];

